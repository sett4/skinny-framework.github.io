<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Validator - Skinny Framework</title>
    <script type="text/javascript" src="//codeorigin.jquery.com/jquery-1.11.0.min.js"></script>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"/>
    <link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="container">
    <div class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">Skinny Framework</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="/documentation" class="dropdown-toggle" data-toggle="dropdown">Documentation&nbsp;<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/getting-started.html">Getting Started</a></li>
                <li><a href="/documentation/scaffolding.html">Scaffolding</a></li>
                <li><a href="/documentation/controller-and-routes.html">Controller & Routes</a></li>
                <li><a href="/documentation/validator.html">Validator</a></li>
                <li><a href="/documentation/view-templates.html">View Templates</a></li>
                <li><a href="/documentation/assets.html">Assets Support</a></li>
                <li><a href="/documentation/mail.html">Mail</a></li>
                <li><a href="/documentation/i18n.html">i18n</a></li>
                <li><a href="/documentation/orm.html">O/R Mapper</a></li>
                <li><a href="/documentation/factory-girl.html">FactoryGirl</a></li>
                <li><a href="/documentation/db-migration.html">DB Migration</a></li>
                <li><a href="/documentation/json.html">Working with JSON</a></li>
                <li><a href="/documentation/tasks.html">Tasks</a></li>
                <li><a href="/documentation/testing.html">Testing</a></li>
                <li><a href="/documentation/packaging.html">Packaging</a></li>
                <li><a href="/contribution.html">Contribution</a></li>
              </ul>
            </li>
            <li><a href="https://groups.google.com/forum/#!forum/skinny-framework">Users Group</a></li>
            <li><a href="https://github.com/skinny-framework/skinny-framework">GitHub</a></li>
            <li><a href="https://travis-ci.org/skinny-framework/skinny-framework"><img src="https://travis-ci.org/skinny-framework/skinny-framework.png" alt="Build Status"></a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
        <div class="col-sm-2">
          <div class="content small">
            <h5>Documentation</h5>
            <hr/>
            <p><a href="/documentation/getting-started.html">Getting Started</a></p>
            <p><a href="/documentation/scaffolding.html">Scaffolding</a></p>
            <p><a href="/documentation/controller-and-routes.html">Controller & Routes</a></p>
            <p><a href="/documentation/validator.html">Validator</a></p>
            <p><a href="/documentation/view-templates.html">View Templates</a></p>
            <p><a href="/documentation/assets.html">Assets Support</a></p>
            <p><a href="/documentation/mail.html">Mail</a></p>
            <p><a href="/documentation/i18n.html">i18n</a></p>
            <p><a href="/documentation/orm.html">O/R Mapper</a></p>
            <p><a href="/documentation/factory-girl.html">FactoryGirl</a></p>
            <p><a href="/documentation/db-migration.html">DB Migration</a></p>
            <p><a href="/documentation/json.html">Working with JSON</a></p>
            <p><a href="/documentation/tasks.html">Tasks</a></p>
            <p><a href="/documentation/testing.html">Testing</a></p>
            <p><a href="/documentation/packaging.html">Packaging</a></p>
            <p><a href="/contribution.html">Contribution</a></p>
          </div>
        </div>
        <div class="col-sm-10">
          <div class="content">
<a href="https://github.com/skinny-framework/skinny-framework"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
            <h2 id="validator">Validator</h2>

<hr/>

<h3 id="readable-and-customizable-dsl">Readable and Customizable DSL</h3>

<hr/>

<p>skinny-validator is portable, so you can use skinny-validator with Play2, Scalatra (without Skinny) and any other web app frameworks. Furthermore, you can use it in not only web apps but also any other applications (batch operation, cli and so on).</p>

<p>You can see simple usage of skinny-validator here:</p>

<p><a href="https://github.com/skinny-framework/skinny-framework/blob/develop/validator/src/test/scala/UsageSpec.scala">validator/src/test/scala/UsageSpec.scala</a></p>

<hr/>

<h3 id="creating-new-validation-rule">Creating New Validation Rule</h3>

<hr/>

<p>The way to create new validation rule is pretty simple:</p>

<ul>
<li>extend <code>skinny.validator.ValidationRule</code> trait</li>
<li>implement <code>def name: String</code> and <code>def isValid(Any): Boolean</code></li>
</ul>

<p>That&rsquo;s all.</p>

<p>The following is an example from the built-in validations.</p>
<pre class="highlight java"><span class="kn">import</span> <span class="nn">skinny.validator._</span>

<span class="n">object</span> <span class="n">required</span> <span class="kd">extends</span> <span class="nf">required</span><span class="p">(</span><span class="kc">true</span><span class="o">)</span>

<span class="k">case</span> <span class="kd">class</span> <span class="nf">required</span><span class="p">(</span><span class="nl">trim:</span> <span class="n">Boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">ValidationRule</span> <span class="o">{</span>
  <span class="n">def</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"required"</span>
  <span class="n">def</span> <span class="n">isValid</span><span class="o">(</span><span class="nl">v:</span> <span class="n">Any</span><span class="o">)</span> <span class="o">=</span> <span class="o">!</span><span class="n">isEmpty</span><span class="o">(</span><span class="n">v</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">trim</span><span class="o">)</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">.</span><span class="na">trim</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">else</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>Then you can use it like this:</p>
<pre class="highlight java"><span class="n">val</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="o">(</span>
  <span class="n">param</span><span class="o">(</span><span class="s">"name"</span> <span class="o">-&gt;</span> <span class="kc">null</span><span class="o">)</span> <span class="n">is</span> <span class="n">required</span>
<span class="o">)</span>
<span class="n">validator</span><span class="o">.</span><span class="na">hasErrors</span> <span class="c1">// true</span>

<span class="n">val</span> <span class="nl">errorsForName:</span> <span class="n">Seq</span><span class="o">[</span><span class="n">Error</span><span class="o">]</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">errors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span>
<span class="n">val</span> <span class="nl">error:</span> <span class="n">Error</span> <span class="o">=</span> <span class="n">errorsForName</span><span class="o">.</span><span class="na">head</span>
<span class="n">error</span><span class="o">.</span><span class="na">name</span> <span class="c1">// -&gt; "required"</span>
<span class="n">error</span><span class="o">.</span><span class="na">messageParmas</span> <span class="c1">// -&gt; List("name")</span>
</pre>
<p>A validation rule which accepts value when using such as <code>minLength(6)</code> is like this:</p>
<pre class="highlight java"><span class="k">case</span> <span class="kd">class</span> <span class="nf">minLength</span><span class="p">(</span><span class="nl">min:</span> <span class="n">Int</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">ValidationRule</span> <span class="o">{</span>
  <span class="n">def</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"minLength"</span>
  <span class="n">override</span> <span class="n">def</span> <span class="n">messageParams</span> <span class="o">=</span> <span class="n">Seq</span><span class="o">(</span><span class="n">min</span><span class="o">.</span><span class="na">toString</span><span class="o">)</span>

  <span class="n">def</span> <span class="n">isValid</span><span class="o">(</span><span class="nl">v:</span> <span class="n">Any</span><span class="o">)</span> <span class="o">=</span> <span class="n">isEmpty</span><span class="o">(</span><span class="n">v</span><span class="o">)</span> <span class="o">||</span> <span class="o">{</span>
    <span class="n">toHasSize</span><span class="o">(</span><span class="n">v</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="n">_</span><span class="o">.</span><span class="na">size</span> <span class="o">&gt;=</span> <span class="n">min</span><span class="o">).</span><span class="na">getOrElse</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;=</span> <span class="n">min</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="n">val</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="o">(</span>
  <span class="n">param</span><span class="o">(</span><span class="s">"name"</span> <span class="o">-&gt;</span> <span class="s">"xxxx"</span><span class="o">)</span> <span class="n">is</span> <span class="n">checkAll</span><span class="o">(</span><span class="n">required</span><span class="o">,</span> <span class="n">minLength</span><span class="o">(</span><span class="mi">6</span><span class="o">)),</span>
  <span class="n">param</span><span class="o">(</span><span class="s">"password"</span> <span class="o">-&gt;</span> <span class="s">"xxxx"</span><span class="o">)</span> <span class="n">is</span> <span class="n">required</span> <span class="o">&amp;</span> <span class="n">minLength</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
<span class="o">)</span>
</pre>
<p>Basic usage involves combining validation rules with <code>&amp;</code>. If a failure is found, by default the rest of the validation rules will be skipped. <code>checkAll</code> executes all the validations even if some of them already failed.</p>

<hr/>

<h3 id="built-in-validation-rules">Built-in Validation Rules</h3>

<hr/>

<p>The built-in validators are good enough to cover most common cases.</p>

<p><a href="https://github.com/skinny-framework/skinny-framework/blob/master/validator/src/main/scala/skinny/validator/BuiltinValidationRules.scala">validator/src/main/scala/skinny/validator/BuiltinValidationRules.scala</a></p>

<p><a href="https://github.com/skinny-framework/skinny-framework/tree/master/validator/src/test/scala/skinny/validator">validator/src/test/scala/skinny/validator</a></p>

<hr/>

<h3 id="validator-&amp;-mapvalidator">Validator &amp; MapValidator</h3>

<hr/>

<p>skinny-validator provides <code>Validator</code> and <code>MapValidator</code>. You already see <code>Validator</code> in above code. This one accepts parameters when defining validation rules.</p>

<p><code>MapValidator</code> is another one which accepts <code>Map[String, Any]</code> object as parameters. Usually <code>MapValidator</code> is more useful in web applications.</p>
<pre class="highlight java"><span class="n">val</span> <span class="n">params</span> <span class="o">=</span> <span class="n">Map</span><span class="o">(</span><span class="s">"name"</span> <span class="o">-&gt;</span> <span class="s">"Alice"</span><span class="o">,</span> <span class="s">"age"</span> <span class="o">-&gt;</span> <span class="mi">20</span><span class="o">)</span>

<span class="n">val</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">MapValidator</span><span class="o">(</span><span class="n">params</span><span class="o">)(</span>
  <span class="n">paramKey</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span> <span class="n">is</span> <span class="n">required</span><span class="o">,</span>
  <span class="n">paramKey</span><span class="o">(</span><span class="s">"age"</span><span class="o">)</span> <span class="n">is</span> <span class="n">required</span> <span class="o">&amp;</span> <span class="n">numeric</span>
<span class="o">)</span>
</pre>
<hr/>

<h3 id="error-messages">Error Messages</h3>

<hr/>

<p>skinny-validator&rsquo;s <code>Error</code> looks like this:</p>
<pre class="highlight java"><span class="n">val</span> <span class="n">error</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">errors</span><span class="o">.</span><span class="na">head</span>
<span class="n">error</span><span class="o">.</span><span class="na">name</span> <span class="c1">// -&gt; required</span>
<span class="n">error</span><span class="o">.</span><span class="na">messageParmas</span> <span class="c1">// -&gt; List("name")</span>
</pre>
<p><code>skinny.validator.Messages</code> loads error messages from *.conf or *.properties.</p>

<p>This is <code>src/main/resources/messages.conf</code> example:</p>
<pre class="highlight plaintext">error {
  required="{0} is required"
  minLength="{0} length must be greater than or equal to {1}"
}
</pre>
<p>Now <code>Messages</code> can load error messages for validation errors named &ldquo;required&rdquo; or &ldquo;minLength&rdquo;. The name comes from <code>ValidationRule#name</code>.</p>
<pre class="highlight java"><span class="n">val</span> <span class="n">messages</span> <span class="o">=</span> <span class="n">Messages</span><span class="o">.</span><span class="na">loadFromConfig</span><span class="o">()</span>
<span class="c1">// val messages = Messages.loadFromConfig("messages2") // loads messages2.conf</span>
<span class="c1">// val messages = Messages.loadFromProperties() // loads messages.properties</span>
<span class="c1">// val messages_ja = Messages.loadFromConfig(locale = Option(locale)) // loads messages_ja.conf</span>

<span class="n">messages</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"required"</span><span class="o">,</span> <span class="n">Seq</span><span class="o">(</span><span class="s">"name"</span><span class="o">))</span> 
<span class="c1">// -&gt; Some("name is required")</span>

<span class="n">messages</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"minLength"</span><span class="o">,</span> <span class="n">Seq</span><span class="o">(</span><span class="s">"password"</span><span class="o">,</span> <span class="mi">6</span><span class="o">))</span> 
<span class="c1">// -&gt; Some("password length must be greater than or equal to 6")</span>
</pre>
<hr/>

<h3 id="how-it-works-in-skinny-apps">How It Works in Skinny apps</h3>

<hr/>

<p>You can easily understand how skinny-valdiator works in Skinny apps.</p>

<p><a href="https://github.com/skinny-framework/skinny-framework/blob/develop/framework/src/main/scala/skinny/controller/feature/ValidationFeature.scala">framework/src/main/scala/skinny/controller/feature/ValidationFeature.scala</a></p>

<p>The following is an example with Skinny Framework:</p>
<pre class="highlight java"><span class="c1">// withDate joins birthdayYear, birthdayMonth and birthdayDay into single birthday</span>
<span class="n">def</span> <span class="n">createParams</span> <span class="o">=</span> <span class="n">Params</span><span class="o">(</span><span class="n">params</span><span class="o">).</span><span class="na">withDate</span><span class="o">(</span><span class="s">"birthday"</span><span class="o">)</span>

<span class="n">def</span> <span class="n">createForm</span> <span class="o">=</span> <span class="n">validation</span><span class="o">(</span><span class="n">createParams</span><span class="o">,</span>
  <span class="n">paramKey</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span> <span class="n">is</span> <span class="n">checkAll</span><span class="o">(</span><span class="n">minLength</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">maxLength</span><span class="o">(</span><span class="mi">20</span><span class="o">)),</span>
  <span class="n">paramKey</span><span class="o">(</span><span class="s">"birthday"</span><span class="o">)</span> <span class="n">is</span> <span class="n">required</span> <span class="o">&amp;</span> <span class="n">dateFormat</span><span class="o">,</span>
  <span class="n">paramKey</span><span class="o">(</span><span class="s">"point"</span><span class="o">)</span> <span class="n">is</span> <span class="n">numeric</span>
<span class="o">)</span>

<span class="n">def</span> <span class="n">createStrongParameters</span> <span class="o">=</span> <span class="n">Seq</span><span class="o">(</span>
  <span class="s">"name"</span> <span class="o">-&gt;</span> <span class="n">ParamType</span><span class="o">.</span><span class="na">String</span><span class="o">,</span>
  <span class="s">"birthday"</span> <span class="o">-&gt;</span> <span class="n">ParamType</span><span class="o">.</span><span class="na">LocalDate</span><span class="o">,</span>
  <span class="s">"point"</span> <span class="o">-&gt;</span> <span class="n">ParamType</span><span class="o">.</span><span class="na">Int</span>
<span class="o">)</span>

<span class="n">def</span> <span class="n">create</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">createForm</span><span class="o">.</span><span class="na">validate</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">val</span> <span class="n">id</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="na">createNewModel</span><span class="o">(</span><span class="n">createParams</span><span class="o">.</span><span class="na">permit</span><span class="o">(</span><span class="n">createStrongParameters</span><span class="o">))</span>
    <span class="n">redirect</span><span class="o">(</span><span class="n">s</span><span class="s">"/members/${id}"</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1">// error messages is set as "errorMessages" and "keyAndErrorMessages"</span>
    <span class="n">render</span><span class="o">(</span><span class="s">"/members/new"</span><span class="o">)</span>
  <span class="o">}</span>
  <span class="c1">// or using #fold</span>
<span class="o">}</span>
</pre>
<p>See also:</p>

<p><a href="https://github.com/skinny-framework/skinny-framework/blob/develop/common/src/main/scala/skinny/ParamType.scala">common/src/main/scala/skinny/ParamType.scala</a></p>

<p><a href="https://github.com/skinny-framework/skinny-framework/blob/develop/common/src/main/scala/skinny/StrongParameters.scala">common/src/main/scala/skinny/StrongParameters.scala</a></p>

            <hr/>
            <div class="alert alert-info small"> 
              If you find a typo or mistake in this page, please report or fix it. <a href="/contribution.html">How?</a>
            </div> 
<a href="https://twitter.com/SkinnyFramework" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @SkinnyFramework</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>

